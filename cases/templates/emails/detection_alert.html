<!DOCTYPE html>
<html>
<head>
    <title>High Priority AI Match Alert</title>
</head>
<body style="font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px;">
    
    <table width="100%" cellpadding="0" cellspacing="0" border="0" style="max-width: 650px; margin: auto; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        <tr>
            <td style="padding: 25px; background-color: #dc3545; color: white; border-radius: 8px 8px 0 0;">
                <h1 style="font-size: 26px; margin: 0;">
                    ðŸš¨ HIGH PRIORITY: MATCH CONFIRMED ðŸš¨
                </h1>
                <p style="font-size: 16px; margin-top: 5px;">
                    IMMEDIATE ACTION REQUIRED: A possible match was found via live surveillance.
                </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 25px;">
                <h2 style="font-size: 18px; color: #333; margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 5px;">
                    Case & Match Summary
                </h2>
                <table width="100%" cellpadding="8" cellspacing="0" border="0" style="font-size: 14px;">
                    <tr>
                        <td style="background-color: #f9f9f9; width: 40%; font-weight: bold; color: #0b4187;">Case ID:</td>
                        <td style="font-weight: bold;">{{ case.complaint_id }}</td>
                    </tr>
                    <tr>
                        <td style="background-color: #f9f9f9; font-weight: bold; color: #0b4187;">Missing Person:</td>
                        <td style="font-weight: bold;">{{ case.missing_name }} ({{ case.missing_age }} yrs)</td>
                    </tr>
                    <tr>
                        <td style="background-color: #f9f9f9; font-weight: bold; color: #0b4187;">Match Confidence:</td>
                        <td style="font-weight: bold; color: green;">{{ similarity }}</td>
                    </tr>
                    <tr>
                        <td style="background-color: #f9f9f9; font-weight: bold; color: #0b4187;">Urgency:</td>
                        <td style="font-weight: bold; color: {% if case.urgency == 'high' %}#dc3545{% else %}#ffc107{% endif %};">{{ case.urgency|upper }}</td>
                    </tr>
                </table>

                <h2 style="font-size: 18px; color: #333; margin-top: 25px; border-bottom: 1px solid #eee; padding-bottom: 5px;">
                    Detection Location
                </h2>
                
                <p style="font-size: 14px; color: #666; margin-bottom: 5px;">
                    Location captured from officer's device:
                </p>
                <p style="font-size: 16px; font-weight: bold; margin-top: 0; color: #333;">
                    {{ location_coords }}
                </p>
                
                {% if location_link %}
                    <a href="{{ location_link }}" 
                       style="display: inline-block; padding: 8px 15px; margin-bottom: 20px; background-color: #0b4187; color: #ffffff; text-align: center; text-decoration: none; border-radius: 4px; font-weight: bold; font-size: 14px;">
                        VIEW ON MAP (GPS Coordinates)
                    </a>
                {% endif %}

                <h2 style="font-size: 18px; color: #333; margin-top: 25px; border-bottom: 1px solid #eee; padding-bottom: 5px;">
                    Evidence Photo
                </h2>
                
                <div style="text-align: center; margin: 20px 0;">
                    <a href="{{ detection_photo_url }}" target="_blank">
                       <img src="cid:{{ image_cid }}" alt="Captured Evidence" style="max-width: 100%; border: 3px solid #dc3545; border-radius: 4px;">
                    </a>
                </div>
                
                <a href="{% url 'cases:detail' case.pk %}" 
                   style="display: block; width: 90%; padding: 15px; margin: 30px auto; background-color: #28a745; color: #ffffff; text-align: center; text-decoration: none; border-radius: 5px; font-weight: bold; font-size: 18px;">
                    GO TO CASE DETAILS (View Evidence Log)
                </a>
            </td>
        </tr>
        <tr>
            <td style="padding: 15px 25px; text-align: center; font-size: 12px; color: #999; border-top: 1px solid #eee;">
                DISCLAIMER: This is an automated AI alert system. Always verify the match before taking definitive action.
            </td>
        </tr>
    </table>
</body>
</html>